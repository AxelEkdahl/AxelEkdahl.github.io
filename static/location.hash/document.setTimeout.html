<!doctype html>
<html><head>
<meta charset="UTF-8">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<title>DOM XSS Test bench</title>
<script>
      function startTimer(seconds) {
        setTimeout(seconds, seconds * 1000);
      }
    </script>
</head>
<body>
	<h1>Test Case: 
	<br /> loction.hash -> document.setTimeout</h1>
	<hr />
    <p><b>Source:</b> location.hash </p>
    <p><b>Sink:</b> document.setTimeout</p>
    <p><b>Solution: </b> </p> 
   	<hr />
  <img src="http://qnimate.com/wp-content/uploads/2014/03/images2.jpg" class="img-responsive"style="width:100px;height:100px;" onload='startTimer(decodeURI(location.hash.substring(location.hash.indexOf("timer=")+6)))' />
	<hr />
	<h2>Source Code</h2>
	<code>
	    <pre>
&#x3C;!doctype html&#x3E;
&#x3C;html&#x3E;&#x3C;head&#x3E;
&#x3C;meta charset=&#x22;UTF-8&#x22;&#x3E;
&#x3C;link rel=&#x22;stylesheet&#x22; href=&#x22;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css&#x22; integrity=&#x22;sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u&#x22; crossorigin=&#x22;anonymous&#x22;&#x3E;
&#x3C;title&#x3E;DOM XSS Test bench&#x3C;/title&#x3E;
&#x3C;script&#x3E;
      function startTimer(seconds) {
        setTimeout(seconds, seconds * 1000);
      }
    &#x3C;/script&#x3E;
&#x3C;/head&#x3E;
&#x3C;body&#x3E;
&#x9;&#x3C;h1&#x3E;Test Case: 
&#x9;&#x3C;br /&#x3E; loction.hash -&#x3E; document.setTimeout&#x3C;/h1&#x3E;
&#x9;&#x3C;hr /&#x3E;
    &#x3C;p&#x3E;&#x3C;b&#x3E;Source:&#x3C;/b&#x3E; location.hash &#x3C;/p&#x3E;
    &#x3C;p&#x3E;&#x3C;b&#x3E;Sink:&#x3C;/b&#x3E; document.setTimeout&#x3C;/p&#x3E;
    &#x3C;p&#x3E;&#x3C;b&#x3E;Solution: &#x3C;/b&#x3E; &#x3C;/p&#x3E; 
   &#x9;&#x3C;hr /&#x3E;
  &#x3C;img src=&#x22;http://qnimate.com/wp-content/uploads/2014/03/images2.jpg&#x22; class=&#x22;img-responsive&#x22;style=&#x22;width:100px;height:100px;&#x22; onload=&#x27;startTimer(decodeURI(location.hash.substring(location.hash.indexOf(&#x22;timer=&#x22;)+6)))&#x27; /&#x3E;
&#x9;&#x3C;hr /&#x3E;
&#x3C;/body&#x3E;
&#x3C;/html&#x3E;

	    </pre>
	</code>
</body>
</html>
