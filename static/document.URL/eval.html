<!doctype html>
<html><head>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<title>DOM XSS Test bench</title></head>
<body>
<h1>Test Case: <br> 
	document.URL->eval </h1>
<hr>
	<b>Source:</b> document.URL <br>
	<b>Sink:</b> eval
<hr>

<script>
function getProduct(pid){
	
}
</script>

<script>
  eval('getProduct(' + document.URL.substring(document.URL.indexOf("pid=")+4) + ')');
</script>

<hr>
<h2>Source Code</h2>
<code>
	<pre>
&#x3C;!doctype html&#x3E;
&#x3C;html&#x3E;&#x3C;head&#x3E;
&#x3C;link rel=&#x22;stylesheet&#x22; href=&#x22;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css&#x22; integrity=&#x22;sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u&#x22; crossorigin=&#x22;anonymous&#x22;&#x3E;
&#x3C;title&#x3E;DOM XSS Test bench&#x3C;/title&#x3E;&#x3C;/head&#x3E;
&#x3C;body&#x3E;
&#x3C;h1&#x3E;Test Case: &#x3C;br&#x3E; document.URL-&#x3E;eval &#x3C;/h1&#x3E;
&#x3C;hr&#x3E;
&#x9;&#x3C;b&#x3E;Source:&#x3C;/b&#x3E; document.URL &#x3C;br&#x3E;
&#x9;&#x3C;b&#x3E;Sink:&#x3C;/b&#x3E; eval
&#x3C;hr&#x3E;

&#x3C;script&#x3E;
function getProduct(pid){
&#x9;
}
&#x3C;/script&#x3E;

&#x3C;script&#x3E;
  eval(&#x27;getProduct(&#x27; + document.URL.substring(document.URL.indexOf(&#x22;pid=&#x22;)+4) + &#x27;)&#x27;);
&#x3C;/script&#x3E;
&#x3C;/body&#x3E;
&#x3C;/html&#x3E;
	</pre>
</code>

</body>
</html>