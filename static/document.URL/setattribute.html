<!doctype html>
<html><head>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<title>DOM XSS Test bench</title></head>
<body>
<h1>Test Case: <br>
 document.URL -> setAttribute</h1>
<hr>
	<b>Source:</b> document.URL <br>
	<b>Sink:</b> element.setAttribute
<hr>

<a id="foo" href='#'>Click me!</a>

<script>
	var redir = document.URL.substring(document.URL.indexOf("url=")+4);
	document.getElementById('foo').setAttribute("href",redir);
</script>
<hr>
<h2>Source Code</h2>
<code>
	<pre>
&#x3C;!doctype html&#x3E;
&#x3C;html&#x3E;&#x3C;head&#x3E;
&#x3C;link rel=&#x22;stylesheet&#x22; href=&#x22;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css&#x22; integrity=&#x22;sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u&#x22; crossorigin=&#x22;anonymous&#x22;&#x3E;
&#x3C;title&#x3E;DOM XSS Test bench&#x3C;/title&#x3E;&#x3C;/head&#x3E;
&#x3C;body&#x3E;
&#x3C;h1&#x3E;Test Case: &#x3C;br&#x3E;
 document.URL -&#x3E; setAttribute&#x3C;/h1&#x3E;
&#x3C;hr&#x3E;
&#x9;&#x3C;b&#x3E;Source:&#x3C;/b&#x3E; document.URL &#x3C;br&#x3E;
&#x9;&#x3C;b&#x3E;Sink:&#x3C;/b&#x3E; element.setAttribute
&#x3C;hr&#x3E;

&#x3C;a id=&#x22;foo&#x22; href=&#x27;#&#x27;&#x3E;Click me!&#x3C;/a&#x3E;

&#x3C;script&#x3E;
&#x9;var redir = document.URL.substring(document.URL.indexOf(&#x22;url=&#x22;)+4);
&#x9;document.getElementById(&#x27;foo&#x27;).setAttribute(&#x22;href&#x22;,redir);
&#x3C;/script&#x3E;
&#x3C;/body&#x3E;
&#x3C;/html&#x3E;
	</pre>
</code>
</body>
</html>