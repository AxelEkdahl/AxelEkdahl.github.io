<html>
  <head>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
	</head>
  <body>
    <h1>Test Case:<br />
    href -> document.write</h1>
    <hr />
    <p><b>Source: </b>location.href</p>
    <p><b>Sink: </b>documnet.write</p>
    <hr />
  <script>
        document.write("<form><select>"); 

        document.write("<option value=1>" + 
        decodeURIComponent(document.location.href.substring(document.location.href.indexOf("default=") + 8)) + "</option>");


        document.write("<option value=2> French </option>");

        document.write("</select> </form>");
        document.write("<a href='" + document.location.href + "?default=%3Cscript%3Ealert(%27hi, you are  vulnerable%27)%3C/script%3E' target=blank> Click here to see the demo in action</a>");
  </script>
  <hr>
<h2>Code<h2>
<code>
  <pre>
&#x3C;html&#x3E;
  &#x3C;head&#x3E;
  &#x3C;link rel=&#x22;stylesheet&#x22; href=&#x22;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css&#x22; integrity=&#x22;sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u&#x22; crossorigin=&#x22;anonymous&#x22;&#x3E;
  &#x3C;/head&#x3E;
  &#x3C;body&#x3E;
    &#x3C;h1&#x3E;Test Case:&#x3C;br /&#x3E;
    href -&#x3E; document.write&#x3C;/h1&#x3E;
    &#x3C;hr /&#x3E;
    &#x3C;p&#x3E;&#x3C;b&#x3E;Source: &#x3C;/b&#x3E;location.href&#x3C;/p&#x3E;
    &#x3C;p&#x3E;&#x3C;b&#x3E;Sink: &#x3C;/b&#x3E;documnet.write&#x3C;/p&#x3E;
    &#x3C;hr /&#x3E;
  &#x3C;script&#x3E;
        document.write(&#x22;&#x3C;form&#x3E;&#x3C;select&#x3E;&#x22;); 

        document.write(&#x22;&#x3C;option value=1&#x3E;&#x22; + 
        decodeURIComponent(document.location.href.substring(document.location.href.indexOf(&#x22;default=&#x22;) + 8)) + &#x22;&#x3C;/option&#x3E;&#x22;);


        document.write(&#x22;&#x3C;option value=2&#x3E; French &#x3C;/option&#x3E;&#x22;);

        document.write(&#x22;&#x3C;/select&#x3E; &#x3C;/form&#x3E;&#x22;);
        document.write(&#x22;&#x3C;a href=&#x27;&#x22; + document.location.href + &#x22;?default=%3Cscript%3Ealert(%27hi, you are  vulnerable%27)%3C/script%3E&#x27; target=blank&#x3E; Click here to see the demo in action&#x3C;/a&#x3E;&#x22;);
  &#x3C;/script&#x3E;
&#x3C;/body&#x3E;
&#x3C;/html&#x3E;
  </pre>
</code>
</body>
</html>